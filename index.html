<!-- 1) Add this CSS (anywhere in your <style> block) -->
<style>
  .modalOverlay{
    position:fixed; inset:0; background:rgba(0,0,0,.6);
    display:none; align-items:center; justify-content:center; z-index:9999;
  }
  .modal{
    width:min(920px, 92vw); background:#121212; color:#eaeaea;
    border:1px solid #2a2a2a; border-radius:14px; padding:16px;
    box-shadow:0 10px 30px rgba(0,0,0,.5);
  }
  .modal h2{ margin:0 0 10px; font-size:1.1rem; }
  .modal textarea{
    width:100%; min-height:240px; padding:10px; border-radius:10px;
    border:1px solid #333; background:#0e0e0e; color:#eaeaea;
    font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
  }
  .modal .actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:12px; }
  .btn{ padding:10px 14px; border:0; border-radius:10px; cursor:pointer; font-weight:700; }
  .btn.primary{ background:#6d5ef9; color:#fff; }
  .btn.secondary{ background:#2b2b2b; color:#eaeaea; }
</style>

<!-- 2) Add this HTML modal (place it anywhere inside <body>, e.g. right before </body>) -->
<div id="importOverlay" class="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="importTitle">
  <div class="modal">
    <h2 id="importTitle">Import playlist from text</h2>
    <p class="muted">Paste one item per line. Format: <code>URL</code> or <code>URL {"{...json...}"}</code></p>
    <textarea id="importTextarea" placeholder="https://example.com/a.webp
https://example.com/clip.mp4 {&quot;loop&quot;:true, &quot;maxSeconds&quot;:8}
https://example.com/b.gif {&quot;seconds&quot;:45}"></textarea>
    <div class="actions">
      <button id="importCancel" class="btn secondary">Cancel</button>
      <button id="importDo" class="btn primary">Import</button>
    </div>
  </div>
</div>

<!-- 3) Replace the old importTxt click handler in your <script> with this -->
<script>
  // Existing: importText(text) and fromModel(items) already defined in your file.

  // Hook up modal
  const importBtn = document.getElementById("importTxt");
  const importOverlay = document.getElementById("importOverlay");
  const importTextarea = document.getElementById("importTextarea");
  const importDo = document.getElementById("importDo");
  const importCancel = document.getElementById("importCancel");

  function openImport(text=""){
    importTextarea.value = text || "";
    importOverlay.style.display = "flex";
    // focus for convenience
    setTimeout(()=>importTextarea.focus(), 0);
  }
  function closeImport(){
    importOverlay.style.display = "none";
  }
  function doImport(){
    const t = importTextarea.value.trim();
    if (!t) { closeImport(); return; }
    importText(t);   // <-- uses your existing helper to parse & render list
    closeImport();
  }

  importBtn.addEventListener("click", ()=> openImport());
  importDo.addEventListener("click", doImport);
  importCancel.addEventListener("click", closeImport);

  // Close on overlay click (but not when clicking inside the dialog)
  importOverlay.addEventListener("click", (e)=>{
    if (e.target === importOverlay) closeImport();
  });

  // Optional: Ctrl+Enter to import, Escape to cancel
  importTextarea.addEventListener("keydown", (e)=>{
    if (e.key === "Escape") { e.preventDefault(); closeImport(); }
    if ((e.ctrlKey || e.metaKey) && e.key === "Enter") { e.preventDefault(); doImport(); }
  });
</script>
